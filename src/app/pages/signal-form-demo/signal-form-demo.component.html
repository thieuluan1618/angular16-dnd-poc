<div class="min-h-screen bg-gradient-to-br from-purple-600 via-purple-500 to-indigo-600 text-gray-900">
  <!-- Header -->
  <header class="bg-white/10 backdrop-blur-lg border-b border-white/20 px-4 py-4">
    <div class="max-w-6xl mx-auto text-center">
      <h1 class="text-3xl md:text-4xl font-bold text-white mb-2 drop-shadow-lg">
        Angular 21 Signal Forms Demo
      </h1>
      <p class="text-base md:text-lg text-white/90 max-w-3xl mx-auto leading-relaxed">
        Modern reactive forms using Angular 21 signals with real-time validation and state management
      </p>
    </div>
  </header>

  <!-- Demo Selector -->
  <div class="bg-white/5 backdrop-blur-md border-b border-white/10 py-2 sticky top-0 z-10">
    <div class="max-w-6xl mx-auto px-4">
      <div class="flex justify-center gap-3 flex-wrap">
        <button
          type="button"
          class="px-4 py-2 bg-white/10 backdrop-blur-lg border border-white/20 text-white/80 font-medium rounded-lg transition-all duration-300 hover:bg-white/20 hover:text-white hover:shadow-lg hover:-translate-y-0.5"
          [class]="activeDemo() === 'user-profile' ? 'bg-white text-purple-600 shadow-xl hover:bg-white hover:shadow-xl hover:-translate-y-0.5' : ''"
          (click)="switchDemo('user-profile')"
          aria-label="Switch to User Profile form demo"
        >
          User Profile
        </button>
        <button
           type="button"
           class="px-4 py-2 bg-white/10 backdrop-blur-lg border border-white/20 text-white/80 font-medium rounded-lg transition-all duration-300 hover:bg-white/20 hover:text-white hover:shadow-lg hover:-translate-y-0.5"
           [class]="activeDemo() === 'contact' ? 'bg-white text-purple-600 shadow-xl hover:bg-white hover:shadow-xl hover:-translate-y-0.5' : ''"
           (click)="switchDemo('contact')"
           aria-label="Switch to Contact form demo"
         >
           Contact Form
         </button>
      </div>
    </div>
  </div>

  <!-- Main Content -->
  <main class="py-4 px-4">
    <div class="max-w-6xl mx-auto">
      <!-- Form Section -->
      <div class="bg-white/95 backdrop-blur-md border border-white/20 rounded-2xl shadow-2xl overflow-hidden mb-4">
        <!-- Form Header -->
        <div class="bg-gradient-to-r from-purple-600 to-indigo-600 text-white px-6 py-8 text-center relative overflow-hidden">
          <div class="absolute inset-0 bg-gradient-to-br from-white/10 via-transparent to-transparent pointer-events-none"></div>
          <h2 class="text-2xl md:text-3xl font-bold mb-2 relative z-10 drop-shadow-lg">
            {{ formTitle() }}
          </h2>
          <p class="text-base text-white/95 relative z-10 leading-relaxed max-w-2xl mx-auto">
            {{ formDescription() }}
          </p>
        </div>

        <!-- Form Actions -->
        <div class="bg-gradient-to-b from-transparent to-white/50 px-6 pt-4 pb-0">
          <div class="flex justify-center gap-3 flex-wrap">
            <button
              type="button"
              class="px-4 py-2 bg-gradient-to-r from-gray-50 to-gray-100 text-gray-700 font-semibold rounded-lg border border-gray-200 shadow-md transition-all duration-300 hover:from-gray-100 hover:to-gray-200 hover:shadow-lg hover:-translate-y-0.5 relative overflow-hidden group"
              (click)="prefillForm()"
              aria-label="Fill form with sample data"
            >
              <span class="relative z-10 flex items-center gap-2">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path>
                </svg>
                üîÑ Pre-fill Form
              </span>
              <div class="absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent -translate-x-full group-hover:translate-x-full transition-transform duration-500"></div>
            </button>
            <button
              type="button"
              class="px-4 py-2 bg-gradient-to-r from-red-50 to-red-100 text-red-700 font-semibold rounded-lg border border-red-200 shadow-md transition-all duration-300 hover:from-red-100 hover:to-red-200 hover:shadow-lg hover:-translate-y-0.5 relative overflow-hidden group"
              (click)="onCancel()"
              aria-label="Reset form"
            >
              <span class="relative z-10 flex items-center gap-2">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                </svg>
                üîÑ Reset Form
              </span>
              <div class="absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent -translate-x-full group-hover:translate-x-full transition-transform duration-500"></div>
            </button>
          </div>
        </div>

        <!-- Form Content -->
        <form class="px-6 py-5 bg-gradient-to-br from-white via-white/90 to-white/80 backdrop-blur-sm" (ngSubmit)="onSubmit()">
          <div class="space-y-5">
            @for (field of currentForm().fields; track field.id) {
              <app-signal-form-field
                [field]="field"
                [errors]="getFieldErrors(field.id)"
                [showErrors]="showErrors()"
                (touchedChange)="onFieldTouched({ fieldId: field.id, touched: $event })"
              />
            }
          </div>

          <!-- Submit Button -->
          <div class="flex justify-center gap-3 mt-6 pt-4 border-t border-gray-200">
            <button
              type="submit"
              [disabled]="currentForm().isSubmitting()"
              class="px-6 py-2 bg-gradient-to-r from-blue-500 to-blue-600 text-white font-semibold rounded-lg shadow-md transition-all duration-300 hover:from-blue-600 hover:to-blue-700 hover:shadow-lg hover:-translate-y-0.5 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2"
            >
              @if (currentForm().isSubmitting()) {
                <span class="inline-block w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"></span>
              }
              Submit Form
            </button>
          </div>
        </form>
      </div>

      <!-- Stats Section -->
      <div class="grid grid-cols-1 lg:grid-cols-3 gap-4 mb-4">
        <!-- Form Stats Card -->
        <div class="bg-white/95 backdrop-blur-md rounded-2xl shadow-xl p-4 border border-white/20">
          <h3 class="text-base font-bold text-gray-900 mb-3">Form Statistics</h3>
          <div class="space-y-2">
            <div class="flex justify-between items-center py-2 border-b border-gray-100">
              <span class="text-sm text-gray-600">Total Fields</span>
              <span class="text-sm font-semibold text-gray-900">{{ getFieldStats().total }}</span>
            </div>
            <div class="flex justify-between items-center py-2 border-b border-gray-100">
              <span class="text-sm text-gray-600">Required</span>
              <span class="text-sm font-semibold text-gray-900">{{ getFieldStats().required }}</span>
            </div>
            <div class="flex justify-between items-center py-2 border-b border-gray-100">
              <span class="text-sm text-gray-600">Valid</span>
              <span class="text-sm font-semibold text-green-600">{{ getFieldStats().valid }}</span>
            </div>
            <div class="flex justify-between items-center py-2">
              <span class="text-sm text-gray-600">Invalid</span>
              <span class="text-sm font-semibold text-red-600">{{ getFieldStats().invalid }}</span>
            </div>
          </div>
        </div>

        <!-- Form Validator Card -->
         <div class="lg:col-span-2">
           <app-signal-form-validator
             [form]="currentForm()"
             [showErrors]="showErrors()"
             [showSubmit]="false"
             [showCancel]="false"
           />
         </div>
      </div>

      <!-- Result Display -->
      @if (submittedData()) {
        <div class="bg-white/95 backdrop-blur-md rounded-2xl shadow-xl p-4 mb-4 border-l-4 border-green-500 border border-white/20">
          <div class="flex items-start gap-3">
            <div class="text-xl flex-shrink-0">‚úÖ</div>
            <div class="flex-1">
              <h3 class="text-base font-bold text-green-800 mb-2">Form Submitted Successfully!</h3>
              <p class="text-gray-700 mb-3 text-sm">
                Your {{ submittedData().type }} form has been processed successfully.
              </p>
              <div class="bg-gray-50 border border-gray-200 rounded-lg p-3 mb-3">
                <h4 class="text-xs font-semibold text-gray-700 mb-2">Submitted Data:</h4>
                <pre class="text-xs text-gray-600 font-mono leading-relaxed overflow-x-auto">{{ getFormattedFormData(submittedData().data) }}</pre>
              </div>
              <p class="text-xs text-gray-500">
                Submitted: {{ submittedData().timestamp | date:'medium' }}
              </p>
            </div>
          </div>
        </div>
      }

      @if (submissionResult() && !submissionResult().success) {
        <div class="bg-white/95 backdrop-blur-md rounded-2xl shadow-xl p-4 mb-4 border-l-4 border-red-500 border border-white/20">
          <div class="flex items-start gap-3">
            <div class="text-xl flex-shrink-0">‚ùå</div>
            <div class="flex-1">
              <h3 class="text-base font-bold text-red-800 mb-2">Submission Failed</h3>
              <p class="text-gray-700">
                {{ submissionResult().message }}
              </p>
            </div>
          </div>
        </div>
      }
      <!-- Info Box: Custom Signal Forms Implementation -->
      <div class="bg-amber-50 border-l-4 border-amber-500 rounded-lg p-6 mt-6">
        <h3 class="text-lg font-bold text-amber-900 mb-3">‚ö†Ô∏è About This Implementation</h3>
        <div class="text-amber-800 space-y-2 text-sm">
          <p>
            <strong>Custom Signal Forms</strong> - This is a production-ready signal-based form system built with Angular 21 signals.
            Angular has an official <a href="https://angular.dev/essentials/signal-forms" target="_blank" class="text-blue-600 hover:underline">experimental Signal Forms API</a>, 
            but it may change in future releases.
          </p>
          <p class="mt-2">
            <strong>Our approach uses:</strong>
          </p>
          <ul class="list-disc list-inside mt-2 space-y-1">
            <li>Angular signals for reactive state (value, errors, dirty, valid states)</li>
            <li>Custom validators: required, email, minLength, maxLength, min, max</li>
            <li>Real-time validation with computed signals</li>
            <li>OnPush change detection (zoneless-compatible)</li>
            <li>Type-safe form field & validator components</li>
          </ul>
        </div>
      </div>
    </div>
  </main>

  <!-- Error Toggle Button (for debugging) -->
  <button
    type="button"
    class="fixed bottom-4 right-4 px-3 py-1.5 bg-white/90 backdrop-blur-md text-gray-700 font-medium rounded-lg shadow-lg border border-white/20 transition-all duration-300 hover:bg-white hover:shadow-xl hover:-translate-y-0.5 text-sm"
    (click)="toggleErrors()"
    aria-label="Toggle error display"
  >
    {{ showErrors() ? 'Hide' : 'Show' }} Errors
  </button>
</div>