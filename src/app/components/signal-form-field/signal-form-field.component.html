<div [class]="containerClasses()" class="relative mb-8">
  <!-- Field Label -->
  @if (field() && field().label) {
    <label [for]="field().id" [class]="labelClasses()" class="block text-sm font-medium text-gray-700 mb-2 transition-colors duration-200">
      {{ field().label }}
      @if (field().required) {
        <span class="text-red-500 ml-1">*</span>
      }
    </label>
  }

  <!-- Field Input -->
  <div class="relative">
    @if (field()) {
      @switch (field().type) {
        @case ('text') {
          <input
            [id]="field().id"
            [type]="field().type"
            [class]="inputClasses()"
            class="w-full px-5 py-4 border-2 border-gray-200 rounded-xl text-base font-medium transition-all duration-300 bg-white text-gray-900 shadow-sm hover:shadow-md hover:border-gray-300 focus:outline-none focus:ring-4 focus:ring-blue-500/15 focus:border-blue-500 focus:shadow-lg focus:-translate-y-0.5"
            [placeholder]="field().placeholder"
            [disabled]="field().disabled()"
            [required]="field().required"
            [ngModel]="fieldValue"
            (ngModelChange)="onValueChange($event)"
            (blur)="onBlur()"
            [attr.aria-invalid]="errors().length > 0 && showErrors()"
            [attr.aria-describedby]="field().id + '-error'"
          />
        }

        @case ('email') {
          <input
            [id]="field().id"
            type="email"
            [class]="inputClasses()"
            class="w-full px-5 py-4 border-2 border-gray-200 rounded-xl text-base font-medium transition-all duration-300 bg-white text-gray-900 shadow-sm hover:shadow-md hover:border-gray-300 focus:outline-none focus:ring-4 focus:ring-blue-500/15 focus:border-blue-500 focus:shadow-lg focus:-translate-y-0.5"
            [placeholder]="field().placeholder"
            [disabled]="field().disabled()"
            [required]="field().required"
            [ngModel]="fieldValue"
            (ngModelChange)="onValueChange($event)"
            (blur)="onBlur()"
            [attr.aria-invalid]="errors().length > 0 && showErrors()"
            [attr.aria-describedby]="field().id + '-error'"
          />
        }

        @case ('password') {
          <input
            [id]="field().id"
            type="password"
            [class]="inputClasses()"
            class="w-full px-5 py-4 border-2 border-gray-200 rounded-xl text-base font-medium transition-all duration-300 bg-white text-gray-900 shadow-sm hover:shadow-md hover:border-gray-300 focus:outline-none focus:ring-4 focus:ring-blue-500/15 focus:border-blue-500 focus:shadow-lg focus:-translate-y-0.5"
            [placeholder]="field().placeholder"
            [disabled]="field().disabled()"
            [required]="field().required"
            [ngModel]="fieldValue"
            (ngModelChange)="onValueChange($event)"
            (blur)="onBlur()"
            [attr.aria-invalid]="errors().length > 0 && showErrors()"
            [attr.aria-describedby]="field().id + '-error'"
          />
        }

        @case ('number') {
          <input
            [id]="field().id"
            type="number"
            [class]="inputClasses()"
            class="w-full px-5 py-4 border-2 border-gray-200 rounded-xl text-base font-medium transition-all duration-300 bg-white text-gray-900 shadow-sm hover:shadow-md hover:border-gray-300 focus:outline-none focus:ring-4 focus:ring-blue-500/15 focus:border-blue-500 focus:shadow-lg focus:-translate-y-0.5"
            [placeholder]="field().placeholder"
            [disabled]="field().disabled()"
            [required]="field().required"
            [ngModel]="fieldValue"
            (ngModelChange)="onValueChange($event)"
            (blur)="onBlur()"
            [attr.aria-invalid]="errors().length > 0 && showErrors()"
            [attr.aria-describedby]="field().id + '-error'"
          />
        }

        @case ('date') {
          <input
            [id]="field().id"
            type="date"
            [class]="inputClasses()"
            class="w-full px-5 py-4 border-2 border-gray-200 rounded-xl text-base font-medium transition-all duration-300 bg-white text-gray-900 shadow-sm hover:shadow-md hover:border-gray-300 focus:outline-none focus:ring-4 focus:ring-blue-500/15 focus:border-blue-500 focus:shadow-lg focus:-translate-y-0.5"
            [disabled]="field().disabled()"
            [required]="field().required"
            [ngModel]="fieldValue"
            (ngModelChange)="onValueChange($event)"
            (blur)="onBlur()"
            [attr.aria-invalid]="errors().length > 0 && showErrors()"
            [attr.aria-describedby]="field().id + '-error'"
          />
        }

        @case ('textarea') {
          <textarea
            [id]="field().id"
            [class]="inputClasses()"
            class="w-full px-5 py-4 border-2 border-gray-200 rounded-xl text-base font-medium transition-all duration-300 bg-white text-gray-900 shadow-sm hover:shadow-md hover:border-gray-300 focus:outline-none focus:ring-4 focus:ring-blue-500/15 focus:border-blue-500 focus:shadow-lg focus:-translate-y-0.5 resize-y min-h-[120px]"
            [placeholder]="field().placeholder"
            [disabled]="field().disabled()"
            [required]="field().required"
            rows="4"
            [ngModel]="fieldValue"
            (ngModelChange)="onValueChange($event)"
            (blur)="onBlur()"
            [attr.aria-invalid]="errors().length > 0 && showErrors()"
            [attr.aria-describedby]="field().id + '-error'"
          ></textarea>
        }

        @case ('select') {
          <div class="relative">
            <select
              [id]="field().id"
              [class]="inputClasses()"
              class="select-arrow w-full px-5 py-4 border-2 border-gray-200 rounded-xl text-base font-medium transition-all duration-300 bg-white text-gray-900 shadow-sm hover:shadow-md hover:border-gray-300 focus:outline-none focus:ring-4 focus:ring-blue-500/15 focus:border-blue-500 focus:shadow-lg focus:-translate-y-0.5 cursor-pointer appearance-none pr-12"
              [disabled]="field().disabled()"
              [required]="field().required"
              [ngModel]="fieldValue"
              (ngModelChange)="onValueChange($event)"
              (blur)="onBlur()"
              [attr.aria-invalid]="errors().length > 0 && showErrors()"
              [attr.aria-describedby]="field().id + '-error'"
            >
              @if (field().placeholder) {
                <option value="" disabled>{{ field().placeholder }}</option>
              }
              @for (option of field().options; track option.value) {
                <option [value]="option.value">{{ option.label }}</option>
              }
            </select>
          </div>
        }

        @case ('checkbox') {
          <label class="flex items-center cursor-pointer gap-4 p-5 bg-slate-50 border-2 border-gray-200 rounded-xl transition-all duration-300 hover:bg-slate-100 hover:border-gray-300 hover:shadow-md hover:-translate-y-0.5">
            <input
              [id]="field().id"
              type="checkbox"
              class="absolute opacity-0 w-0 h-0"
              [disabled]="field().disabled()"
              [ngModel]="fieldValue"
              (ngModelChange)="onValueChange($event)"
              (blur)="onBlur()"
              [attr.aria-invalid]="errors().length > 0 && showErrors()"
              [attr.aria-describedby]="field().id + '-error'"
            />
            <div class="relative w-5 h-5 border-2 border-gray-300 rounded-md bg-white transition-all duration-200 flex-shrink-0 peer-checked:bg-blue-500 peer-checked:border-blue-500 peer-checked:shadow-md peer-hover:border-blue-400 peer-focus:ring-4 peer-focus:ring-blue-500/15">
              &nbsp;
            </div>
            <span class="text-base font-medium text-gray-900 select-none">{{ field().label }}</span>
          </label>
        }
      }
    }
  </div>

  <!-- Validation Errors -->
  @if (showErrors() && errors().length > 0) {
    <div [id]="field().id + '-error'" class="mt-3 space-y-2" role="alert" aria-live="polite">
      @for (error of errors(); track $index) {
        <div class="text-sm text-red-600 leading-relaxed p-3 bg-red-50 border-l-4 border-red-500 rounded-md font-medium animate-slideDown">
          {{ error }}
        </div>
      }
    </div>
  }
</div>

<style>
@keyframes slideDown {
  from {
    opacity: 0;
    transform: translateY(-0.5rem);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.animate-slideDown {
  animation: slideDown 0.3s ease-out;
}

/* Custom checkbox styling */
input[type="checkbox"]:checked + div::before {
  content: 'âœ“';
  position: absolute;
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%);
  color: white;
  font-size: 14px;
  font-weight: bold;
}

/* Custom select arrow styling */
.select-arrow {
  background-image: url('data:image/svg+xml,%3csvg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 20 20"%3e%3cpath stroke="%236b7280" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="m6 8 4 4 4-4"/%3e%3c/svg%3e');
  background-position: right 1rem center;
  background-repeat: no-repeat;
  background-size: 1.5em 1.5em;
}
</style>